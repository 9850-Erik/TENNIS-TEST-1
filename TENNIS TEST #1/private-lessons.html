<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Private Lessons with Erik</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Helvetica Neue', Arial, sans-serif; background: #f9f9f7; color: #1a1a1a; min-height: 100vh; }

    /* NAV */
    nav { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; border-bottom: 1px solid #e8e8e8; background: #fff; position: sticky; top: 0; z-index: 100; }
    .logo { font-size: 1.15rem; font-weight: 700; letter-spacing: -0.5px; }
    .logo span { color: #4caf50; }
    .nav-link { text-decoration: none; font-size: 0.83rem; font-weight: 600; color: #888; border: 1.5px solid #e8e8e8; border-radius: 8px; padding: 7px 14px; transition: all 0.2s; }
    .nav-link:hover { border-color: #1a1a1a; color: #1a1a1a; }
    .admin-btn { background: none; border: 1.5px solid #e8e8e8; border-radius: 8px; padding: 7px 14px; font-size: 0.82rem; font-weight: 600; color: #888; cursor: pointer; font-family: inherit; transition: all 0.2s; margin-left: 8px; }
    .admin-btn:hover { border-color: #1a1a1a; color: #1a1a1a; }

    /* HERO */
    .hero { text-align: center; padding: 64px 24px 48px; position: relative; overflow: hidden; }
    .hero svg.bg-ball { position: absolute; pointer-events: none; opacity: 0.08; }
    .hero h1 { font-size: clamp(2rem, 5vw, 3rem); font-weight: 800; letter-spacing: -1px; margin-bottom: 12px; position: relative; }
    .hero p { color: #666; font-size: 1rem; max-width: 440px; margin: 0 auto; line-height: 1.6; position: relative; }
    .pill { display: inline-block; background: #fff8e1; color: #e65100; border-radius: 100px; padding: 5px 14px; font-size: 0.8rem; font-weight: 600; margin-bottom: 16px; position: relative; }

    /* HOW IT WORKS */
    .how-it-works { max-width: 820px; margin: 0 auto 48px; padding: 0 24px; }
    .steps { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    .step { background: #fff; border: 1.5px solid #e8e8e8; border-radius: 12px; padding: 20px; text-align: center; }
    .step-num { width: 32px; height: 32px; background: #1a1a1a; color: #fff; border-radius: 50%; font-size: 0.82rem; font-weight: 800; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; }
    .step-title { font-weight: 700; font-size: 0.88rem; margin-bottom: 4px; }
    .step-desc { font-size: 0.78rem; color: #999; line-height: 1.5; }

    /* FORM */
    .section { max-width: 820px; margin: 0 auto; padding: 0 24px 60px; }
    .section-label { font-size: 0.78rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: #bbb; margin-bottom: 16px; }

    .request-form { background: #fff; border: 1.5px solid #e8e8e8; border-radius: 16px; padding: 32px; }
    .request-form h2 { font-size: 1.1rem; font-weight: 700; margin-bottom: 6px; }
    .request-form .sub { font-size: 0.84rem; color: #999; margin-bottom: 24px; }

    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; font-size: 0.78rem; font-weight: 700; color: #777; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.4px; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px 13px; border: 1.5px solid #e8e8e8; border-radius: 8px; font-size: 0.93rem; font-family: inherit; background: #fafafa; transition: border-color 0.2s; outline: none; }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus { border-color: #4caf50; background: #fff; }
    .form-group textarea { resize: vertical; min-height: 90px; }

    /* SKILL BTNS */
    .skill-options { display: flex; gap: 8px; flex-wrap: wrap; }
    .skill-btn { padding: 7px 16px; border: 1.5px solid #e8e8e8; border-radius: 100px; background: #fff; font-size: 0.83rem; cursor: pointer; transition: all 0.2s; font-family: inherit; }
    .skill-btn:hover { border-color: #4caf50; }
    .skill-btn.active { background: #4caf50; color: #fff; border-color: #4caf50; }

    /* SHOT OPTIONS */
    .shot-options { display: flex; gap: 8px; flex-wrap: wrap; }
    .shot-btn { padding: 7px 16px; border: 1.5px solid #e8e8e8; border-radius: 100px; background: #fff; font-size: 0.83rem; cursor: pointer; transition: all 0.2s; font-family: inherit; }
    .shot-btn:hover { border-color: #f59e0b; }
    .shot-btn.active { background: #f59e0b; color: #fff; border-color: #f59e0b; }

    /* DURATION */
    .duration-options { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
    .duration-card { border: 1.5px solid #e8e8e8; border-radius: 10px; padding: 14px; text-align: center; cursor: pointer; transition: all 0.2s; }
    .duration-card:hover { border-color: #4caf50; }
    .duration-card.active { border-color: #1a1a1a; background: #f8f8f8; }
    .duration-card .dur-time { font-weight: 800; font-size: 1.1rem; margin-bottom: 2px; }
    .duration-card .dur-price { font-size: 0.75rem; color: #999; }

    /* AVAILABILITY */
    .avail-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }

    .divider { border: none; border-top: 1.5px solid #f0f0f0; margin: 20px 0; }

    .submit-btn { width: 100%; padding: 14px; background: #1a1a1a; color: #fff; border: none; border-radius: 10px; font-size: 0.97rem; font-weight: 700; cursor: pointer; margin-top: 6px; transition: background 0.2s; font-family: inherit; }
    .submit-btn:hover { background: #333; }

    /* SUCCESS */
    .success-screen { display: none; text-align: center; padding: 80px 24px; }
    .success-screen .icon { font-size: 3.5rem; margin-bottom: 18px; }
    .success-screen h2 { font-size: 1.5rem; font-weight: 800; margin-bottom: 10px; }
    .success-screen p { color: #666; max-width: 360px; margin: 0 auto 24px; line-height: 1.6; font-size: 0.92rem; }
    .success-screen button { background: #1a1a1a; color: #fff; border: none; border-radius: 8px; padding: 11px 26px; font-size: 0.93rem; cursor: pointer; font-family: inherit; font-weight: 600; }

    /* ADMIN */
    #adminView { background: #f4f4f2; min-height: 100vh; display: none; }
    .admin-header { background: #1a1a1a; color: #fff; padding: 28px 40px; display: flex; justify-content: space-between; align-items: center; }
    .admin-header h1 { font-size: 1.2rem; font-weight: 700; }
    .admin-header .sub { font-size: 0.8rem; color: #888; margin-top: 2px; }
    .exit-btn { background: #333; border: none; color: #fff; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-family: inherit; font-size: 0.83rem; font-weight: 600; }
    .exit-btn:hover { background: #444; }
    .admin-body { max-width: 860px; margin: 0 auto; padding: 36px 24px; }

    .requests-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; flex-wrap: wrap; gap: 10px; }
    .requests-header h3 { font-size: 1rem; font-weight: 700; }
    .filter-tabs { display: flex; gap: 8px; }
    .filter-tab { padding: 6px 14px; border: 1.5px solid #e8e8e8; border-radius: 100px; background: #fff; font-size: 0.78rem; font-weight: 600; cursor: pointer; font-family: inherit; color: #666; transition: all 0.2s; }
    .filter-tab:hover { border-color: #4caf50; }
    .filter-tab.active { background: #1a1a1a; color: #fff; border-color: #1a1a1a; }

    .request-card { background: #fff; border: 1.5px solid #e8e8e8; border-radius: 12px; padding: 20px 24px; margin-bottom: 12px; }
    .request-card.pending { border-left: 4px solid #f59e0b; }
    .request-card.confirmed { border-left: 4px solid #4caf50; }
    .request-card.declined { border-left: 4px solid #ef4444; opacity: 0.6; }
    .rc-top { display: flex; justify-content: space-between; align-items: flex-start; gap: 16px; flex-wrap: wrap; }
    .rc-name { font-weight: 800; font-size: 1rem; margin-bottom: 3px; }
    .rc-meta { font-size: 0.78rem; color: #999; }
    .rc-tags { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 10px; }
    .rc-tag { display: inline-block; padding: 3px 10px; border-radius: 100px; font-size: 0.72rem; font-weight: 700; }
    .tag-duration { background: #f0f4ff; color: #3b5bdb; }
    .tag-skill { background: #eafbea; color: #2e7d32; }
    .tag-shot { background: #fff8e1; color: #e65100; }
    .rc-focus { margin-top: 10px; font-size: 0.82rem; color: #555; background: #fafafa; border-radius: 8px; padding: 8px 12px; line-height: 1.5; }
    .rc-avail { margin-top: 8px; font-size: 0.8rem; color: #777; }
    .rc-avail span { font-weight: 600; color: #333; }
    .rc-actions { display: flex; gap: 8px; flex-shrink: 0; }
    .confirm-btn { background: #4caf50; color: #fff; border: none; border-radius: 8px; padding: 8px 16px; font-size: 0.8rem; font-weight: 700; cursor: pointer; font-family: inherit; transition: all 0.2s; }
    .confirm-btn:hover { background: #43a047; }
    .decline-btn { background: none; border: 1.5px solid #fca5a5; color: #ef4444; border-radius: 8px; padding: 8px 14px; font-size: 0.8rem; font-weight: 600; cursor: pointer; font-family: inherit; transition: all 0.2s; }
    .decline-btn:hover { background: #fef2f2; }
    .status-badge { display: inline-block; padding: 4px 12px; border-radius: 100px; font-size: 0.72rem; font-weight: 700; }
    .badge-pending { background: #fff8e1; color: #e65100; }
    .badge-confirmed { background: #eafbea; color: #2e7d32; }
    .badge-declined { background: #ffeaea; color: #c62828; }
    .admin-empty { text-align: center; padding: 48px; color: #ccc; background: #fff; border-radius: 12px; border: 1.5px dashed #e8e8e8; font-size: 0.9rem; }

    /* MODAL */
    .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; z-index: 999; }
    .modal-bg.open { display: flex; }
    .modal { background: #fff; border-radius: 16px; padding: 36px; width: 100%; max-width: 340px; text-align: center; }
    .modal h2 { font-size: 1.05rem; font-weight: 800; margin-bottom: 6px; }
    .modal p { font-size: 0.84rem; color: #999; margin-bottom: 20px; }
    .modal input { width: 100%; padding: 11px 14px; border: 1.5px solid #e8e8e8; border-radius: 8px; font-size: 1rem; font-family: inherit; outline: none; text-align: center; letter-spacing: 2px; margin-bottom: 12px; }
    .modal input:focus { border-color: #1a1a1a; }
    .modal-btns { display: flex; gap: 10px; }
    .modal-btns button { flex: 1; padding: 11px; border-radius: 8px; font-size: 0.9rem; font-weight: 700; cursor: pointer; font-family: inherit; border: none; }
    .btn-enter { background: #1a1a1a; color: #fff; }
    .btn-cancel { background: #f0f0f0; color: #555; }
    .modal-err { color: #ef4444; font-size: 0.8rem; margin-bottom: 10px; display: none; }

    .toast { position: fixed; bottom: 28px; left: 50%; transform: translateX(-50%); background: #1a1a1a; color: #fff; padding: 11px 22px; border-radius: 100px; font-size: 0.84rem; font-weight: 600; opacity: 0; transition: opacity 0.3s; pointer-events: none; z-index: 9999; white-space: nowrap; }
    .toast.show { opacity: 1; }

    @media (max-width: 620px) {
      nav { padding: 16px 20px; }
      .form-row, .avail-grid { grid-template-columns: 1fr; }
      .steps { grid-template-columns: 1fr; }
      .duration-options { grid-template-columns: repeat(3, 1fr); }
      .admin-header { padding: 20px; flex-direction: column; align-items: flex-start; gap: 12px; }
      .admin-body { padding: 20px 16px; }
      .rc-top { flex-direction: column; }
      .rc-actions { width: 100%; }
      .confirm-btn, .decline-btn { flex: 1; }
    }
  </style>
</head>
<body>

<div class="toast" id="toast"></div>

<!-- LOGIN MODAL -->
<div class="modal-bg" id="loginModal">
  <div class="modal">
    <div style="font-size:2rem;margin-bottom:12px;">üîê</div>
    <h2>Admin Access</h2>
    <p>Enter your password to manage lesson requests.</p>
    <div class="modal-err" id="loginErr">Wrong password ‚Äî try again.</div>
    <input type="password" id="pwInput" placeholder="Password" onkeydown="if(event.key==='Enter')doLogin()" />
    <div class="modal-btns">
      <button class="btn-cancel" onclick="closeLogin()">Cancel</button>
      <button class="btn-enter" onclick="doLogin()">Enter ‚Üí</button>
    </div>
  </div>
</div>

<!-- NAV -->
<nav>
  <a href="index.html" style="text-decoration:none;display:flex;align-items:center;gap:10px;">
    <svg width="32" height="32" viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg">
      <circle cx="18" cy="18" r="18" fill="#c8e63c"/>
      <path d="M 7 12 Q 13 18 7 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
      <path d="M 29 12 Q 23 18 29 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
      <text x="18" y="23" text-anchor="middle" font-family="Helvetica Neue, Arial, sans-serif" font-size="13" font-weight="900" fill="#1a1a1a">E</text>
    </svg>
    <span style="font-size:1.15rem;font-weight:700;letter-spacing:-0.5px;color:#1a1a1a;">Lessons <span style="color:#4caf50;">with Erik</span></span>
  </a>
  <div style="display:flex;align-items:center;gap:8px;">
    <a class="nav-link" href="liveball-booking.html">‚Üê Liveball</a>
    <button class="admin-btn" onclick="openLogin()">‚öôÔ∏è Admin</button>
  </div>
</nav>

<!-- PLAYER VIEW -->
<div id="playerView">
  <div id="mainContent">

    <div class="hero">
      <!-- Tennis ball top-right -->
      <svg class="bg-ball" style="width:320px;height:320px;top:-80px;right:-60px;" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
        <circle cx="100" cy="100" r="100" fill="#f59e0b"/>
        <path d="M 30 60 Q 60 100 30 140" fill="none" stroke="white" stroke-width="7" stroke-linecap="round"/>
        <path d="M 170 60 Q 140 100 170 140" fill="none" stroke="white" stroke-width="7" stroke-linecap="round"/>
      </svg>
      <!-- Tennis ball bottom-left -->
      <svg class="bg-ball" style="width:260px;height:260px;bottom:-50px;left:-30px;opacity:0.13;" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
        <circle cx="100" cy="100" r="100" fill="#f59e0b"/>
        <path d="M 30 60 Q 60 100 30 140" fill="none" stroke="white" stroke-width="7" stroke-linecap="round"/>
        <path d="M 170 60 Q 140 100 170 140" fill="none" stroke="white" stroke-width="7" stroke-linecap="round"/>
      </svg>
      <!-- Silver tennis ball with E ‚Äî center right -->
      <svg class="bg-ball" style="width:240px;height:240px;top:50%;right:-50px;transform:translateY(-50%);opacity:0.09;" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <radialGradient id="silverGradPL" cx="38%" cy="32%" r="65%">
            <stop offset="0%" stop-color="#ffffff"/>
            <stop offset="40%" stop-color="#c0c8d0"/>
            <stop offset="100%" stop-color="#6b7280"/>
          </radialGradient>
        </defs>
        <circle cx="100" cy="100" r="100" fill="url(#silverGradPL)"/>
        <path d="M 30 60 Q 60 100 30 140" fill="none" stroke="rgba(255,255,255,0.6)" stroke-width="7" stroke-linecap="round"/>
        <path d="M 170 60 Q 140 100 170 140" fill="none" stroke="rgba(255,255,255,0.6)" stroke-width="7" stroke-linecap="round"/>
        <text x="100" y="118" text-anchor="middle" font-family="Helvetica Neue, Arial, sans-serif" font-size="72" font-weight="900" fill="rgba(30,30,40,0.45)">E</text>
      </svg>
      <div class="pill">üéæ One-on-one coaching</div>
      <h1>Private Lessons<br>with Erik</h1>
      <p>Personalized coaching tailored to your game. Request a time and Erik will confirm within 24 hours.</p>
    </div>

    <!-- HOW IT WORKS -->
    <div class="how-it-works">
      <div class="steps">
        <div class="step">
          <div class="step-num">1</div>
          <div class="step-title">Fill out the form</div>
          <div class="step-desc">Tell Erik about your game and when you're available</div>
        </div>
        <div class="step">
          <div class="step-num">2</div>
          <div class="step-title">Erik confirms</div>
          <div class="step-desc">You'll hear back within 24 hours to lock in your slot</div>
        </div>
        <div class="step">
          <div class="step-num">3</div>
          <div class="step-title">Show up & play</div>
          <div class="step-desc">Come ready to work ‚Äî and have fun!</div>
        </div>
      </div>
    </div>

    <!-- REQUEST FORM -->
    <div class="section">
      <div class="section-label">Request a Lesson</div>
      <div class="request-form">
        <h2>Tell Erik about yourself</h2>
        <div class="sub">Fill this out and Erik will get back to you within 24 hours to confirm your slot.</div>

        <!-- Name & Contact -->
        <div class="form-row">
          <div class="form-group"><label>First Name</label><input type="text" id="fname" placeholder="Alex" /></div>
          <div class="form-group"><label>Last Name</label><input type="text" id="lname" placeholder="Johnson" /></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Email</label><input type="email" id="email" placeholder="alex@email.com" /></div>
          <div class="form-group"><label>Phone</label><input type="tel" id="phone" placeholder="+1 (555) 000-0000" /></div>
        </div>

        <hr class="divider" />

        <!-- Lesson Length -->
        <div class="form-group">
          <label>Lesson Length</label>
          <div class="duration-options">
            <div class="duration-card" onclick="selectDuration(this, '30')" id="dur-30">
              <div class="dur-time">30 min</div>
              <div class="dur-price">Quick session</div>
            </div>
            <div class="duration-card" onclick="selectDuration(this, '60')" id="dur-60">
              <div class="dur-time">60 min</div>
              <div class="dur-price">Full session</div>
            </div>
            <div class="duration-card" onclick="selectDuration(this, '90')" id="dur-90">
              <div class="dur-time">90 min</div>
              <div class="dur-price">Deep dive</div>
            </div>
          </div>
        </div>

        <!-- Skill Level -->
        <div class="form-group">
          <label>Skill Level</label>
          <div class="skill-options">
            <button class="skill-btn" onclick="selectSkill(this)">Beginner</button>
            <button class="skill-btn" onclick="selectSkill(this)">Intermediate</button>
            <button class="skill-btn" onclick="selectSkill(this)">Advanced</button>
            <button class="skill-btn" onclick="selectSkill(this)">Competitive</button>
          </div>
        </div>

        <!-- Favorite Shot -->
        <div class="form-group">
          <label>Favorite Shot</label>
          <div class="shot-options">
            <button class="shot-btn" onclick="selectShot(this)">Forehand</button>
            <button class="shot-btn" onclick="selectShot(this)">Backhand</button>
            <button class="shot-btn" onclick="selectShot(this)">Serve</button>
            <button class="shot-btn" onclick="selectShot(this)">Volley</button>
            <button class="shot-btn" onclick="selectShot(this)">Overhead</button>
            <button class="shot-btn" onclick="selectShot(this)">Drop Shot</button>
          </div>
        </div>

        <!-- What to work on -->
        <div class="form-group">
          <label>What do you want to work on?</label>
          <textarea id="focus" placeholder="e.g. My backhand breaks down under pressure, I want to improve my serve consistency..."></textarea>
        </div>

        <hr class="divider" />

        <!-- Availability -->
        <div class="form-group">
          <label>Your Availability</label>
          <div class="avail-grid">
            <div class="form-group" style="margin-bottom:0;">
              <label>Preferred Date</label>
              <input type="date" id="prefDate" />
            </div>
            <div class="form-group" style="margin-bottom:0;">
              <label>Preferred Time</label>
              <input type="time" id="prefTime" />
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Any other days/times that work?</label>
          <textarea id="altAvail" placeholder="e.g. Any weekday morning, or Saturday afternoon..." style="min-height:70px;"></textarea>
        </div>

        <button class="submit-btn" onclick="submitRequest()">Send Request ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- SUCCESS -->
  <div class="success-screen" id="successScreen">
    <div class="icon">üéæ</div>
    <h2>Request sent!</h2>
    <p>Erik will review your request and get back to you within 24 hours to confirm your lesson time.</p>
    <button onclick="resetForm()">Send Another Request</button>
  </div>
</div>

<!-- ADMIN VIEW -->
<div id="adminView">
  <div class="admin-header">
    <div>
      <h1>‚öôÔ∏è Lesson Requests</h1>
      <div class="sub">Private Lessons with Erik ‚Äî Admin Panel</div>
    </div>
    <button class="exit-btn" onclick="exitAdmin()">‚Üê Back to site</button>
  </div>
  <div class="admin-body">
    <div class="requests-header">
      <h3>Incoming Requests</h3>
      <div class="filter-tabs">
        <button class="filter-tab active" onclick="filterRequests('all', this)">All</button>
        <button class="filter-tab" onclick="filterRequests('pending', this)">‚è≥ Pending</button>
        <button class="filter-tab" onclick="filterRequests('confirmed', this)">‚úÖ Confirmed</button>
        <button class="filter-tab" onclick="filterRequests('declined', this)">‚ùå Declined</button>
      </div>
    </div>
    <div id="requestsList"></div>
  </div>
</div>

<script>
  const PASS = 'silvererik27';
  const RK = 'ple_requests';
  let requests = [];
  let currentFilter = 'all';

  function uid() { return Date.now().toString(36)+Math.random().toString(36).slice(2,5); }
  function toast(msg) {
    const el = document.getElementById('toast');
    el.textContent = msg; el.classList.add('show');
    setTimeout(()=>el.classList.remove('show'), 2600);
  }

  function load() {
    try { requests = JSON.parse(localStorage.getItem(RK)||'[]'); }
    catch(e) { requests = []; }
  }
  function save() { localStorage.setItem(RK, JSON.stringify(requests)); }

  // STATE
  let selSkill = null, selShot = null, selDuration = null;

  function selectSkill(btn) {
    document.querySelectorAll('.skill-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active'); selSkill = btn.textContent;
  }
  function selectShot(btn) {
    document.querySelectorAll('.shot-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active'); selShot = btn.textContent;
  }
  function selectDuration(card, dur) {
    document.querySelectorAll('.duration-card').forEach(c=>c.classList.remove('active'));
    card.classList.add('active'); selDuration = dur;
  }

  // LOGIN
  function openLogin() {
    document.getElementById('loginModal').classList.add('open');
    document.getElementById('pwInput').value='';
    document.getElementById('loginErr').style.display='none';
    setTimeout(()=>document.getElementById('pwInput').focus(),100);
  }
  function closeLogin() { document.getElementById('loginModal').classList.remove('open'); }
  function doLogin() {
    if(document.getElementById('pwInput').value===PASS){
      closeLogin(); showAdmin();
    } else {
      document.getElementById('loginErr').style.display='block';
      document.getElementById('pwInput').value='';
      document.getElementById('pwInput').focus();
    }
  }

  function showAdmin() {
    document.getElementById('playerView').style.display='none';
    document.getElementById('adminView').style.display='block';
    renderRequests();
  }
  function exitAdmin() {
    document.getElementById('adminView').style.display='none';
    document.getElementById('playerView').style.display='block';
  }

  // SUBMIT
  function submitRequest() {
    const fname = document.getElementById('fname').value.trim();
    const lname = document.getElementById('lname').value.trim();
    const email = document.getElementById('email').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const focus = document.getElementById('focus').value.trim();
    const prefDate = document.getElementById('prefDate').value;
    const prefTime = document.getElementById('prefTime').value;
    const altAvail = document.getElementById('altAvail').value.trim();

    if(!fname||!lname) { toast('‚ö†Ô∏è Please enter your name.'); return; }
    if(!email) { toast('‚ö†Ô∏è Please enter your email.'); return; }
    if(!selDuration) { toast('‚ö†Ô∏è Please select a lesson length.'); return; }
    if(!selSkill) { toast('‚ö†Ô∏è Please select your skill level.'); return; }

    const req = {
      id: uid(),
      fname, lname, email, phone,
      duration: selDuration,
      skill: selSkill,
      shot: selShot || '‚Äî',
      focus: focus || '‚Äî',
      prefDate, prefTime,
      altAvail: altAvail || '‚Äî',
      status: 'pending',
      ts: new Date().toISOString()
    };

    requests.push(req);
    save();

    // Send to Formspree
    fetch('https://formspree.io/f/xnjbgdgq', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
      body: JSON.stringify({
        type: 'Private Lesson Request',
        name: `${fname} ${lname}`,
        email,
        phone: phone || '‚Äî',
        duration: selDuration,
        skill: selSkill,
        focus_area: selShot || '‚Äî',
        goals: focus || '‚Äî',
        preferred_date: prefDate || '‚Äî',
        preferred_time: prefTime || '‚Äî',
        other_availability: altAvail || '‚Äî'
      })
    }).catch(()=>{}); // silent fail ‚Äî request still goes through

    document.getElementById('mainContent').style.display='none';
    document.getElementById('successScreen').style.display='block';
    window.scrollTo({top:0,behavior:'smooth'});
  }

  function resetForm() {
    selSkill=null; selShot=null; selDuration=null;
    document.getElementById('mainContent').style.display='block';
    document.getElementById('successScreen').style.display='none';
    ['fname','lname','email','phone','focus','prefDate','prefTime','altAvail'].forEach(id=>document.getElementById(id).value='');
    document.querySelectorAll('.skill-btn,.shot-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.duration-card').forEach(c=>c.classList.remove('active'));
    window.scrollTo({top:0,behavior:'smooth'});
  }

  // ADMIN REQUESTS
  function filterRequests(filter, tab) {
    currentFilter = filter;
    document.querySelectorAll('.filter-tab').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    renderRequests();
  }

  function updateStatus(id, status) {
    const r = requests.find(r=>r.id===id);
    if(r) { r.status = status; save(); renderRequests(); }
    const msgs = { confirmed: '‚úÖ Lesson confirmed!', declined: '‚ùå Request declined.' };
    toast(msgs[status]||'Updated.');
  }

  function fmtDate(d) {
    if(!d) return '‚Äî';
    const [y,m,day] = d.split('-').map(Number);
    const days=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
    const months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    const dt = new Date(y,m-1,day);
    return `${days[dt.getDay()]}, ${months[m-1]} ${day}`;
  }
  function fmtTime(t) {
    if(!t) return '‚Äî';
    const [h,m] = t.split(':').map(Number);
    return `${h%12||12}:${String(m).padStart(2,'0')} ${h>=12?'PM':'AM'}`;
  }
  function timeAgo(ts) {
    const diff = (Date.now() - new Date(ts)) / 1000;
    if(diff < 60) return 'just now';
    if(diff < 3600) return `${Math.floor(diff/60)}m ago`;
    if(diff < 86400) return `${Math.floor(diff/3600)}h ago`;
    return `${Math.floor(diff/86400)}d ago`;
  }

  function renderRequests() {
    const el = document.getElementById('requestsList');
    let filtered = currentFilter === 'all' ? requests : requests.filter(r=>r.status===currentFilter);
    filtered = [...filtered].reverse();

    if(!filtered.length) {
      el.innerHTML = `<div class="admin-empty">${currentFilter==='all'?'No requests yet ‚Äî share the page with players!':'No '+currentFilter+' requests.'}</div>`;
      return;
    }

    el.innerHTML = filtered.map(r => {
      const badgeClass = { pending:'badge-pending', confirmed:'badge-confirmed', declined:'badge-declined' }[r.status];
      const badgeLabel = { pending:'‚è≥ Pending', confirmed:'‚úÖ Confirmed', declined:'‚ùå Declined' }[r.status];
      const actions = r.status === 'pending' ? `
        <div class="rc-actions">
          <button class="confirm-btn" onclick="updateStatus('${r.id}','confirmed')">Confirm</button>
          <button class="decline-btn" onclick="updateStatus('${r.id}','declined')">Decline</button>
        </div>` : `<span class="status-badge ${badgeClass}">${badgeLabel}</span>`;

      return `
        <div class="request-card ${r.status}">
          <div class="rc-top">
            <div>
              <div class="rc-name">${r.fname} ${r.lname}</div>
              <div class="rc-meta">${r.email} ¬∑ ${r.phone||'No phone'} ¬∑ ${timeAgo(r.ts)}</div>
              <div class="rc-tags">
                <span class="rc-tag tag-duration">${r.duration} min</span>
                <span class="rc-tag tag-skill">${r.skill}</span>
                ${r.shot!=='‚Äî'?`<span class="rc-tag tag-shot">‚≠ê ${r.shot}</span>`:''}
              </div>
            </div>
            ${actions}
          </div>
          ${r.focus!=='‚Äî'?`<div class="rc-focus">üí¨ "${r.focus}"</div>`:''}
          <div class="rc-avail">üìÖ Preferred: <span>${fmtDate(r.prefDate)} at ${fmtTime(r.prefTime)}</span>${r.altAvail!=='‚Äî'?` ¬∑ Also available: <span>${r.altAvail}</span>`:''}</div>
        </div>`;
    }).join('');
  }

  load();
  renderRequests();
</script>
</body>
</html>
